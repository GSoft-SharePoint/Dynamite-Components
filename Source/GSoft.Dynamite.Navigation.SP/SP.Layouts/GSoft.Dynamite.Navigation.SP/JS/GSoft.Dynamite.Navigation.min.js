window.Dynamite=window.Dynamite||{},function(n,t){function r(n){var t=this,r=1;t.Nodes=ko.observableArray();_.each(n,function(u){t.Nodes.push(new i(u.Title,u.Url,u.ChildNodes,r,n.length,u.IsCurrentNode,u.IsNodeInCurrentBranch))});t.CurrentNodeChildren=ko.computed(function(){var n=_.find(t.Nodes(),function(n){return n.IsNodeInCurrentBranch()});return n?n.ChildNodes():[]})}function i(t,r,u,f,e,o,s){var h=this,c,l;h.Title=ko.observable(t);h.Url=ko.observable(r);h.ChildNodes=ko.observableArray();h.ChildNodes1=ko.observableArray();h.ChildNodes2=ko.observableArray();h.ChildNodes3=ko.observableArray();h.ChildNodes4=ko.observableArray();h.Level=ko.observable(f);h.NbUncles=ko.observable(e);h.IsCurrentNode=ko.observable(o);h.IsNodeInCurrentBranch=ko.observable(s);h.LevelClass=ko.computed(function(){var n="main-menu-level-"+h.Level(),t=h.IsCurrentNode()?"current-node":"",i=h.IsNodeInCurrentBranch()?"node-in-current-branch":"",r=h.ChildNodes2().length>0?"main-menu-2-col":"",u=h.ChildNodes().length>0?"main-menu-dropdown":"";return[n,t,i,r,u].join(" ")});h.NextLevelClass=ko.computed(function(){var n=h.ChildNodes2().length>0?"main-menu-2-col":"",t="main-menu-level-"+(h.Level()+1);return[t,n].join(" ")});c=0;l=u.length;h.Level()===3&&(l=h.NbUncles());_.each(u,function(t){h.ChildNodes.push(new i(t.Title,t.Url,t.ChildNodes,h.Level()+1,l));c<n.Level4Max?h.ChildNodes1.push(new i(t.Title,t.Url,t.ChildNodes,h.Level()+1,l)):h.NbUncles()<3&&c<n.Level4Max*2?h.ChildNodes2.push(new i(t.Title,t.Url,t.ChildNodes,h.Level()+1,l)):h.NbUncles()===1&&c<n.Level4Max*3?h.ChildNodes3.push(new i(t.Title,t.Url,t.ChildNodes,h.Level()+1,l)):h.NbUncles()===1&&c<n.Level4Max*4&&h.ChildNodes4.push(new i(t.Title,t.Url,t.ChildNodes,h.Level()+1,l));c++});c>=n.Level4Max&&h.NbUncles()>=3?h.ChildNodes1.push(new i("voir plus",h.Url(),[],99)):c>=n.Level4Max*2&&h.NbUncles()<3?h.ChildNodes2.push(new i("voir plus",h.Url(),[],99)):c>=n.Level4Max*4&&h.NbUncles()===1&&h.ChildNodes4.push(new i("voir plus",h.Url(),[],99))}n.ViewModel=null;n.HideDelay=600;n.ShowDelay=300;n.HideDelayTimeout=null;n.ShowDelayTimeout=null;n.Level4Max=6;n.initialize=function(i,u){t(document).ready(function(){n.ViewModel=new r(i,u);ko.applyBindings(n.ViewModel,t("#main-menu")[0]);t(window).bind("load",function(){var i=t("ul.main-menu-level-2"),u=i.width()-1,r=0;_.each(i.children("li"),function(n){r+=t(n)[0].getBoundingClientRect().width});t("li.main-menu-level-1").mouseenter(n.MouseEnterTab);t("div.main-menu-level-2").mouseenter(n.MouseEnterMenu);t("ul.main-menu-level-2").mouseleave(n.MouseLeave);t("li.main-menu-level-1").mouseleave(n.MouseLeave);t("html").click(function(){t("div.main-menu-level-2").hide();window.clearTimeout(n.HideDelayTimeout)});t("#main-menu").click(function(n){n.stopPropagation()});t("div.main-menu-level-3").css("top",i.outerHeight()+"px")})})};n.MouseEnterTab=function(i){window.clearTimeout(n.HideDelayTimeout);n.ShowDelayTimeout=window.setTimeout(function(){window.clearTimeout(n.HideDelayTimeout);t("div.main-menu-level-2").hide();t(i.currentTarget).next().show()},n.ShowDelay)};n.MouseEnterMenu=function(){window.clearTimeout(n.HideDelayTimeout);window.clearTimeout(n.ShowDelayTimeout)};n.MouseLeave=function(){window.clearTimeout(n.ShowDelayTimeout);n.HideDelayTimeout=window.setTimeout(function(){t("div.main-menu-level-3").hide()},n.HideDelay)}}(Dynamite.MainMenu=Dynamite.MainMenu||{},jq111);
//# sourceMappingURL=GSoft.Dynamite.Navigation.min.js.map
